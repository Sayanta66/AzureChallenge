const connection=(new signalR.HubConnectionBuilder).withUrl("/challengeHub").build();$(document).ready(function(){var n=parseInt($("#Started").val()),t=parseInt($("#Finished").val());configureChart(n,t);rawData.forEach(function(n){var t=n.split(":"),u=new Date(parseInt(t[2]),parseInt(t[3])-1,parseInt(t[4])),r=new Date,i;r.setDate(r.getDate()-6);u>=r&&(i=parseInt(t[1]),questionData[i]?questionData[i].push(t[0]):questionData[i]=[t[0]])});chartSeries=Array.from(Array(questionData.length),(n,t)=>questionData[t]?questionData[t].length:0);new Chartist.Bar("#questionCompletionChart",{labels:Array.from(Array(chartSeries.length),(n,t)=>t+1),series:[chartSeries]},{seriesBarDistance:10,horizontalBars:!0,reverseData:!0,axisY:{offset:20,showLabel:!0},axisX:{onlyInteger:!0,showLabel:!0},plugins:[Chartist.plugins.ctAxisTitle({axisX:{axisTitle:"Number of users completed",axisClass:"ct-axis-title",offset:{x:0,y:30},textAnchor:"middle"},axisY:{axisTitle:"Question Index",axisClass:"ct-axis-title",offset:{x:0,y:-1},flipTitle:!1}})]})});var configureChart=function(n,t){if(n+t>0){var i={series:[n,t]};new Chartist.Pie("#numOfUsersChart",{labels:["Started","Finished"],series:i.series},{donut:!0,showLabel:!0,plugins:[Chartist.plugins.legend()],labelInterpolationFnc:function(n,t){return i.series[t]===0?"":i.series[t]}})}};connection.on("QuestionComplete",function(n){var t,r;if(console.log(n),t=n.split(":"),r=new Date,parseInt(t[2])===r.getFullYear()&&parseInt(t[3])===r.getMonth()+1&&parseInt(t[4])===r.getDate()){var u=t[0],i=parseInt(t[1]),e=questionData[i],f=[];questionData.forEach(function(n,t){n.includes(u)?n.forEach(function(n){n!==u&&(f[t]=n)}):f[t]=n});questionData=f;questionData[i]&&questionData[i].length>0?questionData[i].push(u):questionData[i]=[u];chartSeries=Array.from(Array(questionData.length),(n,t)=>questionData[t]?questionData[t].length:0);new Chartist.Bar("#questionCompletionChart",{labels:Array.from(Array(questionData.length),(n,t)=>t+1),series:[chartSeries]},{seriesBarDistance:10,horizontalBars:!0,reverseData:!0,axisY:{offset:20,showLabel:!0},axisX:{onlyInteger:!0,showLabel:!0},plugins:[Chartist.plugins.ctAxisTitle({axisX:{axisTitle:"Number of users completed",axisClass:"ct-axis-title",offset:{x:0,y:30},textAnchor:"middle"},axisY:{axisTitle:"Question Index",axisClass:"ct-axis-title",offset:{x:0,y:-1},flipTitle:!1}})]})}});(()=>{try{await connection.start();await connection.invoke("AddToGroup",$("#ChallengeId").val())}catch(n){console.error(n.toString())}})();